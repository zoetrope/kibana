[[setup]]
== Kibanaのセットアップ
すぐにKibanaをセットアップしてElasticsearchのインデックスを探索することができます。
必要なのはこれだけ:

* Elasticsearch 2.0.0 またはそれ以降
* モダンなWebブラウザ - http://www.elastic.co/subscriptions/matrix#matrix_browsers[Supported Browsers].
* Elasticsearchのインストールに関する情報:
** 接続したいElasticsearchのインスタンスのURL
** 検索したいElasticsearchのインデックス

NOTE: Elasticsearchが http://www.elastic.co/overview/shield/[Shield] により保護されている場合は、
{shield}/kibana.html#using-kibana4-with-shield[Shield with Kibana 4] の追加の手順を確認してください。

[float]
[[install]]
=== Kibanaのインストールと開始

To get Kibana up and running:

. https://www.elastic.co/downloads/kibana[Kibana 4 binary package] からプラットフォームに応じたファイルをダウンロードします。
. `.zip` または `tar.gz` のアーカイブファイルを展開します。

// On Unix, you can instead run the package manager suited for your distribution.
//
// [float]
// include::kibana-repositories.asciidoc[]
//
インストール後、インストールディレクトリで `bin/kibana` (Linux/MacOSX) または `bin\kibana.bat` (Windows) を実行します。

以上です！ Kibanaは5601番ポートで起動しています。

[float]
[[kibana-dynamic-mapping]]
==== KibanaとElasticsearchのDynamic Mapping
デフォルトでは、Elasticsearchは、フィールドの{ref}dynamic-mapping.html[dynamic mapping] は有効になっています。
Kibanaでは、正しく可視化をおこなうために、フィールドのDynamic Mappingを利用する必要があります。
また `.kibana` インデックス(検索条件の保存、可視化、ダッシュボードの格納のために利用するインデックス)を管理するためにも必要です。

もしDynamic Mappingを無効にしてElasticsearchを利用しているのであれば、Kibanaが可視化のために利用するフィールドを、手動でマッピングする必要があります。
また `.kibana` インデックスのDynamic Mappingを主導で有効にする必要もあります。

以下の手続きを実行する際にはElasticsearchに `.kibana` インデックスがまだ存在せず、 `elasticsearch.yml` の `index.mapper.dynamic` の設定が `false` になっているものとします。

. Elasticsearchを起動します。
. Dynamic Mappingが有効な `.kibana` インデックスを作成します:
+
[source,shell]
PUT .kibana
{
	"index.mapper.dynamic": true
}
+
. Kibanaを起動し、WebブラウザでKibanaのUIを開き、Dynamic Mappingに関するエラーメッセージが表示されていないことを確認します。

[float]
[[connect]]
=== Connect Kibana with Elasticsearch
Kibanaを利用し始める前に、探索したいElasticsearchのインデックスを教えてあげる必要があります。
Kibanaに初めてアクセスしたとき、インデックスの名前にマッチする _インデックスパターン_ を1つまたはいくつか定義するように促されます。
Kibanaを使い始めるのに必要な設定はそれだけです。
インデックスパターンは <<settings-create-pattern,Settings tab>> から、いつでも追加することができます。

TIP: デフォルトではKibanaは `localhost` で実行されているElasticsearchインスタンスに接続します。
他のElasticsearchインスタンスに接続する場合は、 `kibana.yml` のElasticsearch URLの設定を書き換えて、Kibanaを再起動します。
Kibanaをプロダクション環境で利用する場合の情報については <<production>> をご覧ください。

KibanaでアクセスしたいElasticsearchのインデックスを設定する方法:

. WebブラウザでKibanaのUIを開きます。例: `localhost:5601` , `http://YOURDOMAIN.com:5601`
+
image:images/Start-Page.jpg[Kibana start page]
+
. Elasticsearchのインデックスにマッチするインデックスパターンを明示します。
デフォルトでは、KibanaはLogstashによってElasticsearchにデータが投入されたと推測します。
もしそれが事実なら、デフォルトの `logstash-*` というインデックスパターンが利用できます。
アスタリスク `(*)` は、ゼロ文字以上の任意の文字列にマッチします。
もしElasticsearchのインデックスが他の命名規約に従っているのであれば、適切なパターンを入力してください。
また"pattern"は、単純な一つのインデックス名だけを指定することも可能です。
. 時間に基づいたデータの比較をおこないたいのであれば、タイムスタンプを含むフィールドを選択してください。
Kibanaは、タイムスタンプを含むフィールドをすべてリストアップするために、インデックスのマッピングを読み取ります。
もし、インデックスが時系列データを持たないのであれば、 *Index contains time-based events* オプションを無効にしてください。
. 新しいインデックスが定期的に作られて、そのインデックス名にタイムスタンプが含まれる場合は *Use event times to create index names* オプションを有効にし *Index pattern interval* を選択してください。
これは、指定した期間のデータを含むインデックスだけを検索するようになるので、検索性能が改善します。
Logstashを使ってElasticsearchにデータを入れているのであれば、もっとも適切な設定です。
. *Create* ボタンをクリックして、インデックスパターンを追加します。
最初につくったパターンは、自動的にデフォルトとして設定されます。
複数のインデックスを作った場合は、 *Settings > Indices* から、デフォルトとして利用するインデックスを指定することができます。

ほら！ Kibanaは今Elasticsearchのデータにつながっています。
Kibanaは、マッチしたインデックスに設定されたフィールドの一覧(読み取り専用)を表示します

[float]
[[explore]]
=== データを探索し始めよう!
データに潜る準備はできました:

* <<discover, Discover>> ページでは、対話的にデータの検索や閲覧がおこなえます。
* <<visualize, Visualize>> ページでは、データからグラフや地図をつくることができます。
* <<dashboard, Dashboard>> ページでは、カスタマイズしたダッシュボードをつくったり見たりできます。

Kibanaのコアコンセプトを体験するための簡単なチュートリアルは <<getting-started, Getting Started>> をご覧ください。
