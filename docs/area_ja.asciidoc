[[area-chart]]
=== Area Charts

このグラフのY軸は _metrics_ の軸です。
この軸には、以下のaggregationを利用することができます:

*Count*:: {ref}/search-aggregations-metrics-valuecount-aggregation.html[_count_] aggregationは、選択されたインデックスパターンの要素数を返します。
*Average*:: {ref}/search-aggregations-metrics-avg-aggregation.html[_average_] aggregationは、数値フィールドの平均値を返します。ドロップダウンからフィールドを選択してください。
*Sum*:: {ref}/search-aggregations-metrics-sum-aggregation.html[_sum_] aggregation は、数値フィールドの合計値を返します。ドロップダウンからフィールドを選択してください。
*Min*:: {ref}/search-aggregations-metrics-min-aggregation.html[_min_] aggregation は、数値フィールドの最小値を返します。
ドロップダウンからフィールドを選択してください。
*Max*:: {ref}/search-aggregations-metrics-max-aggregation.html[_max_] aggregation は数値フィールドの最大値を返します。
ドロップダウンからフィールドを選択してください。
*Unique Count*:: {ref}/search-aggregations-metrics-cardinality-aggregation.html[_cardinality_] aggregation は、フィールドの中のユニークな値の数を返します。
ドロップダウンからフィールドを選択してください。
*Percentiles*:: {ref}/search-aggregations-metrics-percentile-aggregation.html[_percentile_] aggregation は、数値フィールドの値を指定した幅のパーセンタイルに分割します。
ドロップダウンからフィールドを選択し、 *Percentiles* フィールドの範囲を1つ以上指定してください。
*×* をクリックするとパーセンタイルフィールドを削除できます。
*+ Add* をクリックすると、パーセンタイルフィールドを追加できます。
*Percentile Rank*:: {ref}/search-aggregations-metrics-percentile-rank-aggregation.html[_percentile ranks_] aggregationは、指定した数値フィールドの値のパーセンタイルランキングを返します。
ドロップダウンからフィールドを選択し、 *Percentiles* フィールドの範囲を1つ以上指定してください。
*×* をクリックするとパーセンタイルフィールドを削除できます。
*+ Add* をクリックすると、パーセンタイルフィールドを追加できます。

*+ Add Aggregation* ボタンをクリックすると、aggregationを追加することができます。

include::x-axis-aggs_ja.asciidoc[]
たとえば、日付ごとの問題の発生数のグラフを年代順に表示することができます。
また、もっともアクティブな日付を最初に表示するために、問題報告のaggregationの優先度を上げることができます。
年代順に並び替えることで、問題の発生数が時間に依存しているというパターンを示すかもしれません。
そして、アクティブな日付順で並び替えることで、データの異常値が見えるようになるかもしれません。

*Advanced* リンクをクリックすると、metricやbucket aggregationのより詳細なオプションを表示することができます。

*Exclude Pattern*:: 結果からこのフィールドを除外するためのパターンを指定します。
*Exclude Pattern Flags*:: Exclude Patternでマッチさせるときに利用するフラグ(Javaの正規表現用)を指定します。
*Include Pattern*:: 結果にこのフィールドを含めるためのパターンを指定します。
*Include Pattern Flags*:: Include Patternでマッチさせるときに利用するフラグ(Javaの正規表現用)を指定します。
*JSON Input*:: aggregationの定義にマージするJSON形式のプロパティを追加できるテキストフィールドです。以下に例を示します:

[source,shell]
{ "script" : "doc['grade'].value * 1.2" }

NOTE: Elasticsearch 1.4.3 かそれ以降では、この機能を利用するためには {ref}/modules-scripting.html[dynamic Groovy scripting] を有効にする必要があります。

上記のオプションが利用できるかどうかは、選択したaggregationによって変化します。

*Options* タブを選択すると、グラフの以下の性質を変更することができます:

*Chart Mode*:: 複数のY軸のaggregationを定義している場合、グラフ上でどのようにaggregationを表示するかを以下から選択することができます:

_stacked_:: それぞれのaggregationを上に積みあげます。
_overlap_:: aggregationを重ね合わせ、重なった領域は半透明で示します。
_wiggle_:: https://en.wikipedia.org/wiki/Streamgraph[streamgraph] としてaggregationを表示します。
_percentage_:: それぞれのaggregationを合計の割合として表示します。
_silhouette_:: それぞれのaggregationを中央線からの偏差として表示します。

チェックボックスで以下の振る舞いの有効・無効を切り替えることができます:

*Smooth Lines*:: チェックすると、点と点を結んだときの領域の頂点を滑らかにします。
*Set Y-Axis Extents*:: チェックを入れて、 *y-max* と *y-min* フィールドに値を入力すると、Y軸の最大値・最小値を設定できます。
*Scale Y-Axis to Data Bounds*:: デフォルトでは、Y軸の範囲は0からデータの最大値になっています。
チェックを入れると、下限と上限の両方の範囲が、データの値にマッチするようになります。
*Show Tooltip*:: チェックを入れるとツールチップを表示します。
*Show Legend*:: チェックを入れると、グラフの近くに凡例を表示します。

